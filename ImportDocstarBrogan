Sub ImportDocstarBrogan()
    Dim ws As Worksheet
    Dim csvFilePath As String
    Dim qt As QueryTable
    
    ' IMPORT CSV
    csvFilePath = GetUserSelectedFile("Please select Docstar (Brogan) data file:")
    Set ws = DocstarBrogan
    Set qt = ws.QueryTables.Add(Connection:="TEXT;" & csvFilePath, Destination:=ws.Range("A1"))
    
    With qt
        .TextFileParseType = xlDelimited
        .TextFileCommaDelimiter = True
        .TextFileColumnDataTypes = Array(1) ' Treat all columns as text
        .Refresh BackgroundQuery:=False
    End With
    qt.Delete
    
    ' CREATE TABLE
    Dim tbl As ListObject
    Set tbl = ws.ListObjects.Add(SourceType:=xlSrcRange, _
                                 Source:=ws.Range("A1").CurrentRegion, _
                                 xlListObjectHasHeaders:=xlYes)
    tbl.Name = "DCSTRBRGN"
    
    ' DELETE UNNECESSARY COLUMNS (DIFFERENT FOR EACH DATABASE!)
    Columns("A:D").Select
    Selection.Delete Shift:=xlToLeft
    
    ' CHANGE INVOICE# INTO NUMBER TYPE WITH TEXT TO COLUMNS
    Range("A:A").Select
    Selection.TextToColumns Destination:=Range("A:A"), _
        DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, _
        Tab:=False, _
        Semicolon:=False, _
        Comma:=False, _
        Space:=False, _
        Other:=False, _
        FieldInfo:=Array(1, 1), _
        TrailingMinusNumbers:=True
        
    Sheets("Table").Select
    Range("TABLE[Docstar]").Select
    ActiveCell.FormulaR1C1 = "=VLOOKUP(RC[-5],DCSTRBRGN,6,FALSE)"
    
    Range("TABLE[Amount match]").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-3]=VLOOKUP(RC[-6],DCSTRBRGN,3,FALSE),""Y"",""N"")"
    Range("G3").Select
End Sub