Sub ImportDocstarBrogan()
    Dim selectedFile As String
    DOCSTARBROGAN = GetUserSelectedFile("Please select Docstar file:")
    
    ActiveWorkbook.Queries.Add Name:="DCSTRBRGN", Formula:= _
        "let" & _
        "    Source = Csv.Document(File.Contents(""" & DOCSTARBROGAN & """), " & _
        "[Delimiter="","", Columns=15, Encoding=1252, QuoteStyle=QuoteStyle.None])," & _
        "    #""Promoted Headers"" = Table.PromoteHeaders(Source, [PromoteAllScalars=true])," & _
        "    #""Changed Type"" = Table.TransformColumnTypes(#""Promoted Headers"", { " & _
        "{""Document Link"", type text}, " & _
        "{""Title"", type text}, " & _
        "{""VendorName"", type text}, " & _
        "{""VendorID"", Int64.Type}, " & _
        "{""InvoiceNum"", type text}, " & _
        "{""InvoiceDate"", type date}, " & _
        "{""InvoiceAmt"", Currency.Type}, " & _
        "{""PONum"", Int64.Type}, " & _
        "{""Branch"", type text}, " & _
        "{""Workflow Step"", type text}, " & _
        "{""VoucherNumber"", Int64.Type}, " & _
        "{""Created On"", type datetime}, " & _
        "{""Modified On"", type datetime}, " & _
        "{""Annotation Text"", type text}, " & _
        "{""Workflow Name"", type text} })," & _
        "in" & _
        "    #""Changed Type"""
        
    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _
        "OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=DCSTRBRGN;Extended Properties=""""" _
        , Destination:=Range("$A$1")).QueryTable
        .CommandType = xlCmdSql
        .CommandText = Array("SELECT * FROM [DCSTRBRGN]")
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .ListObject.DisplayName = "DCSTRBRGN"
        .Refresh BackgroundQuery:=False
    End With
    
    ' DELETE UNNECESSARY COLUMNS (DIFFERENT FOR EACH DATABASE!)
    Columns("A:D").Select
    Selection.Delete Shift:=xlToLeft
    
    ' CHANGE INVOICE NO INTO NUMBER TYPE WITH TEXT TO COLUMNS
    Range("A:A").Select
    Selection.TextToColumns Destination:=Range("A:A"), _
        DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, _
        Tab:=False, _
        Semicolon:=False, _
        Comma:=False, _
        Space:=False, _
        Other:=False, _
        FieldInfo:=Array(1, 1), _
        TrailingMinusNumbers:=True
        
    Sheets("Table").Select
    Range("TABLE[Docstar]").Select
    ActiveCell.FormulaR1C1 = "=VLOOKUP(RC[-5],DCSTRBRGN,6,FALSE)"
    
    Range("TABLE[Amount match]").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-3]=VLOOKUP(RC[-6],DCSTRBRGN,3,FALSE),""Y"",""N"")"
    Range("G3").Select
End Sub