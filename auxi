Sub DeleteAllColumnsExceptSelected()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim selectedColumns As Variant
    Dim col As ListColumn
    Dim colName As String
    Dim colNamesToDelete As Collection
    Dim i As Long
    
    ' Set the worksheet and table where you want to delete columns
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Change "Sheet1" to your target sheet name
    Set tbl = ws.ListObjects("Table1") ' Change "Table1" to your table name
    
    ' Specify the names of the columns you want to keep
    selectedColumns = Array("Column1", "Column2") ' Change to your column names
    
    ' Create a collection to hold the names of columns to delete
    Set colNamesToDelete = New Collection
    
    ' Loop through all columns in the table
    Dim colName As String
    For Each col In tbl.ListColumns
        colName = col.Name
        If IsError(Application.Match(colName, selectedColumns, 0)) Then
            colNamesToDelete.Add colName
        End If
    Next col
    
    ' Loop through the collection of columns to delete and delete them
    For i = colNamesToDelete.Count To 1 Step -1
        tbl.ListColumns(colNamesToDelete(i)).Delete
    Next i
End Sub

Sub RearrangeColumns()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim colOrder As Variant
    Dim colName As String
    Dim colIndex As Long
    Dim i As Long
    
    ' Set the worksheet and table
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Change to your sheet name
    Set tbl = ws.ListObjects("MyTable") ' Change to your table name
    
    ' Define the desired column order
    colOrder = Array("Column1", "Column2", "Column3") ' Change to your desired order
    
    ' Loop through the desired order and move the columns
    For i = LBound(colOrder) To UBound(colOrder)
        colName = colOrder(i)
        colIndex = tbl.ListColumns(colName).Index
        
        ' Move the column to the desired position
        If colIndex <> i + 1 Then
            tbl.ListColumns(colName).Range.Cut
            tbl.ListColumns(i + 1).Range.Insert Shift:=xlToRight
        End If
    Next i
    
    ' Optional: AutoFit the columns after rearranging
    tbl.Range.Columns.AutoFit
End Sub

